![]( \image\集中化版本控制.jpg)

![]( \image\分布式版本控制.jpg)

1. 集中式版本控制（SVN）是存储不同版本之间的差异，版本回滚速度很慢
2. 分布式版本控制（Git）是存储最新版本的和以前所有版本的索引，Git中用了极致的压缩算法和解压算法，占用内存较低
3. Linux的开发人林纳斯因为Bitkeeper不免费然后偷偷看，然后把Git做出来了，然后Git就变成了开源免费
4. 安装完后鼠标点击Git Bash Here打开Git终端
5. Git的本地结构（不涉及远程结构）分为三个部分：
   - 工作区：写代码的地方
   - 暂存区：打算提交但是还有没提交的地方，做一个临时存储的区域，可以提交到本地库或者撤回
   - 本地库：存储的是真正的每个历史版本的信息

![]( \image\本地结构.jpg)

## 代码托管中心本地库和远程库的交互方式

![]( \image\本地库作用.jpg)

![]( \image\团队内部协作.jpg)

1. 经理创建本地库后通过push推送到远程库后，程序员先通过clone、加入团队获得授权后才能有权限推送到远程库，程序员通过push推送后，经理通过pull操作就能够拉取

![](\image\跨团队协作.jpg)

托管中心种类：

局域网下：可以搭建GitLab服务器作为代码托管中心，GitLab可以自己去搭建

外网环境下，可以由GitHub或者Gitee作为代码托管中心，GitHub或者Gitee是现成的托管中心，不用自己搭建

## 初始化本地仓库：

1. 创建一个文件夹

2. 打开Git终端，终端界面可以通过Ctrl和滚轮放大缩小字体，在界面右键可以查看选项，可以调整字体并将编码设置为UTF-8

3. Git中的命令和Linux是一样的

   + git --version查看版本

   + clear 清屏

   + 设置用户名和邮箱：

     > git config[^配置] --global[^全局] user.name “用户名称”
     >
     > git config[^配置] --global[^全局] user.email “用户邮箱”

4. 本地仓库初始化

   + 可以通过cd 路径或在指定文件夹下打开Git终端转移到其他目录
   + 通过git init 在当前目录初始化一个仓库
   + 通过ll查看所有文件，通过ll -la查看所有文件（包括隐藏）
   + 文件列表“-”开头的是文件、“d”开头是文件夹
   + 配置信息都放在config文件下
   + 注意事项：git目录下的本地库相关的子目录和子文件不要删除，不要乱改

## 常用命令add和commit

1. 先在有git仓库的目录下创建一个文件
2. 将文件提交到暂存区：git add 文件
3. 将暂存区提交到本地仓库：git commit -m[^注释参数] “注释” 文件
4. 不指定提交文件，会提交暂存区的所有文件
5. cd .. 退到上一层
6. 不放在本地仓库中的文件，git是不进行管理
7. 即使放在本地仓库的文件，git也不管理，必须通过add，commit命令操作才可以将内容提交到本地库

## 常用命令status

1. git status 查看工作区和暂存区的状态
2. 首先会显示当前分支，其次会提示可以执行的操作，文件不同颜色表示所有文件在两个区中的状态，红色表示在工作区（未被git管理），绿色表示在暂存区
3. 修改内容后，再查看状态，add提交后红色优惠变成绿色

## 常用命令log

1. git log 可以看到最近和最远的历史记录
2. 历史记录中commit后面的16进制是当前历史记录对应的索引，key：索引；value：历史记录对应的具体内容
3. 索引的值是唯一的，是通过哈希算法进行加密算出来的，Author表示的是作者和邮箱，Date表示的是提交的时间和提交的注释
4. 记录是从近到远的 
5. 当记录过多的时候，可以看到页面底部有冒号，点击空格进入下一页，点击b返回上一页，到尾页显示end，退出为q

**日志展示方式：**

+ git log [^分页]  

+ git log --pretty=oneline[^不显示重复作者和时间] 

+ git log --oneline [^不显示全部索引和重复作者、时间] （<font color=red>报错：无法识别的参数</font>）
+ git reflog[^查看部分索引和可回退的部分,翻译：回流] ，多了HEAD@{数字}，数字表示回退到这个版本需要多少步

## 常用命令reset

1. reset命令：前进或者后退历史版本

2. 语法格式：git reset --参数 索引[^跳转到指定索引版本] 

3. 通过查看日志可看到指针指定完的最新版本，在历史记录中高亮指向的为当前指向的版本

4. >复制：在终端中选中就是复制
   >
   >粘贴：右键paste

5. + hard参数：本地库指针移动的同时，重置暂存区和工作区
   + mixed参数：本地库指针移动的同时，重置暂存区，工作区不变。
   + soft参数：本地库指针移动的同时，暂存区和工作区不变
   + 总结：以后用的最多的是第一种hard参数

## 常用命令删除文件找回本地库删除的文件

1. 新建一个文件
2. 将它add到暂存区中
3. 再通过commit提交到本地库中
4. 删除工作区中的新建文件（rm 文件名）
5. 将删除操作同步到暂存区，再同步到本地库 （add 删除的文件名）
6. 查看日志
7. 找回本地库中删除的文件，实际上就是将历史版本切换到刚才添加文件的那个版本即可

## 常用命令找回暂存区删除的文件

1. 删除工作区数据
2. 同步到缓存区
3. 找回方法和本地库一样，需要搞明白hard参数的具体作用

## 常见命令diff命令

1. 先创建一个文件，添加到暂存区，再提交到本地库
2. 更改工作区中新建文件中的内容，增加内容（导致工作区和暂存区不一致）
3. git diff 文件名：将**工作区**和**暂存区**中的文件进行对比，git按行为单位来管理，红色是删除，绿色是增加
4. 多个文件比对，会显示所有文件的差异
5. git diff 索引号 文件名：将**暂存区**和**本地库**进行对比，HEAD表示本地库当前所对应指针指向版本，索引号表示要进行对比的版本

## 分支

1. 在版本控制过程中，使用多条线同时推进多个任务。这里说的多条线，就是多个分支
2. 一般新的独立的功能要进行一个独立的分支
3. 独立的分支是在主分支的基础上复制来的，另外的新的功能也会开辟一个新的分支
4. 在主分支以外的分支是彼此独立的，相互之间互不影响
5. 分支的合并说明新功能开发完毕，和源程序结合，使得源程序生成一个新的版本
6. 和源程序生成的版本出现bug后会出现一个新的分支[^热分支] ，bug的修复在热分支上，用户在主分支上的功能不影响正常使用

 ![]( \image\分支.jpg) 
1. 多个分支可以并行开发，互相不耽误，互相不影响，提高开发效率
2. 如果有一个分支功能开发失败，直接删除这个分支就可以了，不会对其他分支产生任何影响

## 查看分支、创建分支、切换分支

1. 在工作区创建一个新文件，提交到暂存区和本地库
2. 查看分支：git branch -v，*表示当前分支，不同分支后面的索引一样，说明版本一样
3. 创建分支：git branch[^分支] 分支名
4. 切换分支：git checkout 分支名[^已存在的] 

## 解决分支冲突问题

**在同一个文件的同一个位置中修改会出现冲突问题**

<font color=red>疑问：同一个文件中不同位置将如何进行修改？</font>

?

<font color=red>疑问：在本机上进行操作始终无法创建冲突？</font>

答案：在新分支上修改内容后，主分支不做修改，新分支合并主分支后会覆盖主分支的内容，原因是没有创建冲突，在分支图上是新版本覆盖了老版本，所以不会进入合并状态，直接覆盖；正确创建冲突的方式是新分支修改内容后，在主分支也同样修改内容，在两个分支都创建新的版本合并时才可以创建冲突

1. 进入新分支，增加内容

2. 再将分支切换到主分支，查看主分支的内容，可以看到另一个分支的索引变化了，而原分支的内容不变

3. 再在主分支中，然后在主分支下加入内容

4. 再次切换到新分支中查看分支状态，可以看到分支的索引

5. 查看文件内容：cat 文件名，可以看到新分支中的内容和主分支的不一样了

6.  将新分支和主分支里面合并：
	> 1. 进入主分支
	>
	> 2. 将新分支内容和主分支内容进行合并：git merge[^合并] 新分支名
	>
	> 3. 分支后面显示MERGING表示处在一个合并的状态
	>
	> 4. ![]( \image\出现冲突.jpg)
	>
	> 5. 查看冲突文件：cat 文件名，可以看到当前分支和新分支不同的内容，先是当前分支修改的内容，然后是合并过来的分支中修改的内容
	>
	> 6. 解决：
	>
	>    >商议决定想要的，改完之后工作区和缓存区都不一样了
	>    >
	>    >![]( \image\解决冲突.jpg)
	>    >
	>    >所有冲突已经解决，但是仍然处于合并状态，需要使用commit来解决
	>    >
	>    >将工作区中内容添加到暂存区，然后进行commit操作
	>    >
	>    >解决合并commit时不能带文件名，否则会报错
	>    >
	>    >commit以后就不是合并状态
	

## 删除分支

1. **git branch -d** 分支名[^需要删除的]：
   + 用于删除已经被合并的分支。它只有在分支已经被合并到其他分支时才能成功删除。如果分支尚未合并，Git会提示你需要先合并分支
   + 如果分支没有被合并，Git会提示你需要先合并分支。
2. **git branch -D **分支名[^需要删除的]：
   + 强制删除分支，即使分支尚未合并。这个命令会直接删除分支，即使有未完成的提交。
   + **注意：删除分支后，该分支上的所有提交历史都将被永久删除。因此，在删除分支之前，确保已经备份了重要的提交历史记录。**

## 注册GitHub账号

1. git和远程库进行一个远程操作，远程库选择的是GitHub
2. 登录GitHub官网进行注册，邮箱尽量不要使用163的，不然可能会收不到验证码 
## 进行实操

1. 指定路径初始化本地库
2. 创建数据（新文件）
3. 推送到本地库
4. 创建GitHub远程仓库 
   + Owner表示的是所有者
   + Repository name表示仓库名，一般和本地库名字相同
   + Description表示仓库描述（可选）

## 在本地创建远程库地址的别名

1. 点进GitHub的仓库

2. HTTPS格式、git后缀的地址是远程库的地址

3. 在git本地通过别名将地址保存[^远程库地址比较长，每次复制比较麻烦]

4. 查看远程仓库的地址是否有别名：git remote -v

5. 为远程库起别名[^修改后可通过别名访问该地址]：git remote add 别名 远程仓库地址

6. 再次查看别名： 
	>fetch表示可以从该地址进行取回
	>
	>push表示可以从该地址进行推送
	>

## 推送操作（项目经理）

1. 推送：git  push 远程库别名 分支名[^需要推送的分支]（第一次登录该分支会显示登录界面）
2. ![]( \image\分支推送.jpg)
3. 将本地库的master分支提交到远程库的master分支
4. ![]( \image\创建新分支.jpg)
5. 在远程库创建新分支
6. 推送成功后可再GitHub上进行查看

## 克隆操作（程序员）

1. 在其他路径进行克隆操作：
  > 1. 在GitHub仓库中点击克隆选项，复制克隆地址[^远程库地址] 
  > 2. 克隆操作：git clone 克隆地址

2. git remote -v （在这里的作用：查看别名）

3. 切换路径（仓库下）

4. 克隆操作可以自动完成：
	> 1. 初始化本地库
	>
	>    <font color=red>疑问：未自动创建.git文件</font>
	>
	> 2. 将远程库内容完整的克隆到本地（拉取了以远程库名称为文件夹名的文件）
	> 3. 替我们创建远程库的别名
	>
	>    <font color=red>疑问：生成的远程库名默认为origin？</font>

## 邀请加入团队push操作*

1. 更新本地库的信息
2. 推送：git push 远程库名[^别名] 分支名
3. 在一台机器上不会显示加入团队[^因为本地存在缓存]，正常应该会要求输入新的账号和密码，或报错
4. 在控制面板中查找”管理你的凭据“，可以看到普通凭据中存在GitHub的凭据，将其进行删除
5. 重新进行更新本地库操作

​	1. 删除后出现端口失败连接不到服务器可参考[git报错：Failed to connect to github.com port 443 after 21084 ms: Couldn‘t connect to serve-CSDN博客](https://blog.csdn.net/qq_43651168/article/details/131074308)

1. 重新进行推送操作，发现需要重新输入GitHub账号密码，输入新的账号密码后发现报错
2. 需要加入团队，登录项目经理的账号邀请程序员账号加入团队，GitHub中”settings“--》”Manage access“
3. 在列表中点击”Pending invite“可以复制邀请连接
4. 切换GitHub程序员账号，在地址栏录入邀请连接即可接收邀请
5. 再次进行推送操作，发现需要输入程序员的账号和密码
6. 查看GitHub仓库可看到程序员推送的账号已经到GitHub远程库中

## 远程库修改的拉取*

1. pull相当于fetch[^拉取]和merge[^合并] 操作
2. 先通过项目经理的账号确认程序员账号更新了远端仓库内容
3. 再通过项目经理账号进行拉取
4. 拉取：git fetch 别名[^远端库] 分支[^远端库] 
5. 在抓取操作执行后，只是将远程库的内容下载到本地，但是工作区中还是原来的内容

​	<font color=red>疑问：如何查看下载的内容?</font>

1. 切换到远程库中进行查看，查看远程库列表中有什么内容，内容是否正确
2. 内容正确后进行合并，合并之前应切换到原分支
3. 进行合并：git merge  别名/分支名

​	<font color=red>fatal: refusing to merge unrelated histories(拒绝合并不相关的历史)</font>

1. 远程库的拉取可以直接利用pull命令来完成，当代码简单时可以直接用pull进行操作，需要保证代码正确就需要通过fetch和merge操作

 ## 协作开发合作时冲突的解决办法*

1. 先在项目经理的库中，更新内容并推送到远端库
2. 将凭据删除，然后进入程序员的本地库，拉取更新的数据
3. **操作同一个文件的同一个位置就会引起冲突**
4. 用程序员账号更新（增加）内容并推送
5. 将程序员的凭据删除，通过项目经理的账号改动[^在相同的位置进行修改]更新的文件，并推送
6. 输入项目管理员的账号和密码
7.  发现推送失败，**在冲突的情况下，应该拉取后修改冲突完再推送到远程仓库**
8. 先拉取，拉取后查看冲突文件[^包含冲突信息] 
9. 对比后，人为解决冲突（该删删，该留留）
10. 解决完冲突后再重新提交，（注意：当前冲突状态，提交不可以带文件名），并推送
11. 使用项目经理的账号进入GitHub仓库查看更新文件内容，查看是否解决了冲突

## 跨团队合作*

1. 得到远程库的地址[^远端库的https地址]
2. 通过外部程序员进行fork操作，通过在地址栏粘贴远端库地址
3. 点击“fork”，将协作文件复制到外部远端库
4. 再通过克隆操作将外部远端库的内容克隆到外部本地库，并更新内容提交
5. 以外部程序员的账号进行推送
6. 以外部程序员账号在GitHub上进行pull request操作， 点击”pull request“新建请求
7. 登录项目管理员账号，查看请求，可在请求中进行回信
8. 登录外部程序员账号可以看到相互留言的记录
9. 可以在”files changed“中查看外部程序员进行的修改操作，确认后可以进行合并
10. 点击合并并确定就可以进行合并操作

## SSH免密登录

在win10系统中有记录凭据的功能，删除后每次push都需要进行输入密码操作。

1. 进入用户的主目录中[^USER/用户名] ：cd

2. 执行命令，生成一个.ssh的目录：ssh-keygen[^key generation] -t rsa -C[^一定要大写] 用户邮箱[^Github账号注册的邮箱]，点击三次回车确认默认值

3. 生成了一个.ssh文件，目录下有两个文件，打开pub后缀文件将里面的内容进行复制操作

4. 打开GitHub设置，设置中”SSH and GPG key“，设置标题，将复制的内容粘贴到key栏中，并点击添加

5. 生成密钥以后就可以进行正常的push操作

6. 先将SSH的地址进行复制，再在终端中起别名，展示别名查看是否起名成功

7. 更新本地库并推送（使用新起的SSH别名进行推送）

8. **首次使用时系统会询问是否信任远程主机并保存公钥指纹，需要填写“yes”后回车**

9. > ssh好处：不用每次都进行身份验证
   >
   > 缺陷：只能针对一个账号

## IDEA集成Git初始化本地库添加暂存区提交本地库操作

1. 创建一个新项目作为一个本地仓库，
2. setting中的Version Control中找到Git，在地址栏中添加Git.exe的安装路径，应用
3. 本地库的初始化操作：
	>  1. VCS--》input into version Control--》Create Git Repository[^创建Git初始化仓库] 
	>  2. 选择需要初始化的位置，就生成了.git目录
	
4. 在创建一个新文件后会提示是否ADD到暂存区，绿色是已添加

5. 如果未执行操作，则通过右键的Git选择相应的操作

6. 通过commit可选中需要提交的所有文件，commit message相当于是-m后面的参数

7. 提交成功之后会产生一个version Control，相当于一个Git的控制台，log相当于查看日志的功能

8. 更新内容，代码前面出现绿色竖条说明文件和文件库中不一样

9. 通过commit操作之后（或在commit界面点击文件查看），选中修改的文件查看下方可查看到两个文件中的不同之处

## 通过IDEA拉取和推送资源 ？

1.  因为要把两个不同的命令合并，Git需要添加一句代码，在git pull之后，这句代码是在git 2.9.2版本发生的，最新版本需要添加--allow-unrelated-histories，**告诉git允许不相关历史合并**
2. 假如我们的源是origin（不同的库需要重新设置别名，否则就需要换成https或ssh地址），分支是master，那么我们需要这样写git pull origin master --allow-unrelated-histories
3. 输入完之后需要添加备注，i插入，Esc退出，（参考vim）
4. （疑问：拉取后是如何合并或两个同时存在？）
5. 这个方法只解决**因为两个仓库有不同的开始点**，也就是两个仓库没有共同的commit出现的无法提交。如果使用该方法还无法提交，需要看一下是不是发生了冲突，解决冲突再提交
6. push推送：git push -u origin master -f
7. 登录GitHub仓库查看是否推送到远端库（到这里本地库和远程库就进行同步了）
8. 再在IDEA中更新（新建）内容，并提交到本地库
9. 再通过右键找到push操作，首次push需要增加推送地址，需要起别名和增加地址
10. 增加成功后就会显示将本地库中的什么分支推送到远端库中的什么分支，以及提交内容
11. 推送成功之后在GitHub上进行查看，看时候推送成功
12. 在commit选项中可直接进行commit+push操作
13. 一般来说会先拉取查看内容，拉取查看没有冲突再进行push操作

## 使用IDEA克隆远程仓库到本地

1. IDEA中的克隆： IDEA中file--》New--》Project from version Control--》Git（或git--》clone）
2. 输入远程库的地址，同时可以更改本地库存放的地址（默认文件夹名和远程库的仓库名相同）
3. 点击Test可以测试能否和远程库进行连接
4. <font color=red>疑问：未出现测试选项</font>
5. 克隆成功之后可以选择是否在新窗口打开，克隆到本地库，这个目录即变成了一个本地库，又变成了一个工作空间

## 使用IDEA解决冲突、如何避免冲突*

1. 更新本地库内容并推送到远端库的分支上（命令行操作）
2. 进入GitHub仓库中查看内容
3. 在IDEA中使用不同账号进行相同修改操作（创建冲突），并推送
4. ![]( \image\IDEA冲突问题.jpg)
5. 说明这个分支master里面被拒绝了，说明远程的已经改变了，告诉我们在push之前需要先进行合并，就能看到冲突（点击合并）
6. ![]( \image\冲突选择.jpg)
7. 选择你需要用的版本，可以是你的或别人的，也可以是进行合并操作
8. 点击Merge[^合并] 会出现对比页面，Result[^原先的] 、Your[^你的] 、远端库的；
9. 点击》可以将修改的添加到原来的，点击《可以将另一边的添加过来，将内容进行一个合并，点击应用
10. 本地工作区的代码就更新了，推送到远端库

## 如何避免冲突：

1. 团队开发的时候避免在一个文件中改代码
2. 在修改一个文件前，在push之前，先进行pull操作
